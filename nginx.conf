user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log notice;
pid        /var/run/nginx.pid;

events {
  worker_connections  1024;
}

http {
  include       /etc/nginx/mime.types;
  default_type  application/octet-stream;

  log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

  access_log  /var/log/nginx/access.log  main;

  sendfile           on;
  keepalive_timeout  65;

  server {
    listen 80;
    listen [::]:80;

    server_name _;

    location /netflix/seinfeld {
      content_by_lua_block {
        math.randomseed(ngx.now()*1000)

        local base_url = "https://www.netflix.com/watch/"
        local episodes = {
          -- Season 1
          "80132845", "80132847", "80132848", "80132846", "80132849",
          -- Season 2
          "80132850", "80132851", "80132854", "80132856", "80132857", "80132859", "80132861", "80132860", "80132914", "80132853", "80132855", "80132852",
          -- Season 3
          "80132793", "80132794", "80132795", "80132796", "80132798", "80132797", "80132799", "80132900", "80132901", "80132858", "80132902", "80132903", "80132905", "80132906", "80132904", "80132907", "80132913", "80132908", "80132909", "80132910", "80132911", "80132912",
          -- Season 4
          "80132862", "80132863", "80132864", "80132866", "80132867", "80132868", "80132869", "80132870", "80132871", "80132872", "80132873", "80132874", "80132876", "80132875", "80132878", "80132877", "80132879", "80132880", "80132882", "80132883", "80132881", "80132865",
          -- Season 5
          "80132672", "80132674", "80132673", "80132675", "80132676", "80132677", "80132679", "80132678", "80132680", "80132681", "80132682", "80132683", "80132685", "80132684", "80132686", "80132687", "80132688", "80132692", "80132689", "80132691", "80132690",
          -- Season 6
          "80132916", "80132917", "80132918", "80132919", "80132920", "80132921", "80132922", "80132923", "80132924", "80132925", "80132926", "80132927", "80132928", "80132929", "80132930", "80132931", "80132932", "80132933", "80132934", "80132935", "80132936", "80132937", "80132938",
          -- Season 7
          "80132939", "80132940", "80132941", "80132942", "80132943", "80132944", "80132945", "80132946", "80132947", "80132948", "80132949", "80132950", "80132951", "80132952", "80132953", "80132954", "80132955", "80132956", "80132957", "80132958", "80132959", "80132960",
          -- Season 8
          "80132693", "80132694", "80132695", "80132696", "80132697", "80132698", "80132699", "80133000", "80133001", "80133002", "80133003", "80133004", "80133005", "80133006", "80133007", "80133008", "80133009", "80133010", "80133011", "80133012", "80133013", "80133014",
          -- Season 9
          "80133015", "80133016", "80133017", "80133018", "80133019", "80133020", "80133021", "80133022", "80133023", "80133024", "80133025", "80133026", "80133027", "80133028", "80133029", "80133030", "80133031", "80133032", "80133033", "80133034", "80133035", "80133036"
        }
        local random_episode = episodes[math.random(1, #episodes)]

        ngx.redirect(base_url .. random_episode)
      }
    }

    location /netflix/strangerthings {
      content_by_lua_block {
        math.randomseed(ngx.now()*1000)

        local base_url = "https://www.netflix.com/watch/"
        local episodes = {
          -- Season 1
          "80077368", "80077369", "80077370", "80077371", "80077372", "80077373", "80077374", "80077375",
          -- Season 2
          "80117716", "80144891", "80144892", "80144893", "80144894", "80144895", "80144896", "80144897", "80144898",
          -- Season 3
          "80186941", "80222773", "80222774", "80222775", "80222776", "80222777", "80222778", "80222779",
          -- Season 4
          "80229866", "80229867", "80229868", "80229869", "80229870", "80229871", "80229872", "80229873", "81227938",
        }
        local random_episode = episodes[math.random(1, #episodes)]

        ngx.redirect(base_url .. random_episode)
      }
    }
  }
}
