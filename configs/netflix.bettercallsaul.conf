# This location block redirects a request to a random episode of the show 'Better Call Saul'
# https://www.imdb.com/title/tt3032476
location /netflix/bettercallsaul {
  content_by_lua_block {
    math.randomseed(ngx.now()*1000)

    local base_url = "https://www.netflix.com/watch/"
    local episodes = {
      -- Season 1
      "80021956", "80021957", "80021963", "80021958", "80021962", "80021959", "80021960", "80021961", "80021965",
      -- Season 2 
      "80084676", "80084677", "80084669", "80084668", "80084670", "80084671", "80084673", "80084672", "80084674", "80084675",
      -- Season 3 
      "80170698", "80171003", "80171000", "80170699", "80171001", "80171002", "80170695", "80170694", "80170697", "80170696",
      -- Season 4 
      "80235116", "80235112", "80235114", "80235109", "80235113", "80235117", "80235110", "80235118", "80235115", "80235111",
      -- Season 5 
      "81232204", "81232200", "81232205", "81232201", "81232202", "81232203", "81232209", "81232207", "81232208", "81232206",
      -- Season 6
      -- TODO: Not on Netflix yet
    }
    local random_episode = episodes[math.random(1, #episodes)]

    ngx.redirect(base_url .. random_episode)
  }
}
