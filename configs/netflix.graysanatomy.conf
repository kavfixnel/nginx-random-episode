# This location block redirects a request to a random episode of the show 'Grey's Anatomy'
# https://www.imdb.com/title/tt0413573/
location /netflix/greysanatomy {
  content_by_lua_block {
    math.randomseed(ngx.now()*1000)

    local base_url = "https://www.netflix.com/watch/"
    local episodes = {
      -- Season 1
      "70158903", "70158900", "70158907", "70158906", "70158901", "70158902", "70158908", "70158905", "70158904",
      -- Season 2
      "70158928", "70158929", "70158932", "70158933", "70158934", "70158920", "70158910", "70158912", "70158913", "70158923", "70158931", "70158926", "70158921", "70158930", "70158909", "70158919", "70158918", "70158911", "70158916", "70158924", "70158914", "70158917", "70158922", "70158915", "70158935", "70158927", "70158925",
      -- Season 3
      "70158942", "70158956", "70158952", "70158957", "70158958", "70158951", "70158936", "70158939", "70158947", "70158946", "70158954", "70158943", "70158960", "70158945", "70158941", "70158940", "70158955", "70158949", "70158953", "70158944", "70158959", "70158938", "70158950", "70158948", "70158937",
      -- Season 4
      "70158976", "70158975", "70158977", "70158972", "70158971", "70158974", "70158973", "70158970", "70158961", "70158967", "70158966", "70158969", "70158968", "70158963", "70158965", "70158964", "70158962",
      -- Season 5
      "70123446", "70123429", "70123431", "70123428", "70123430", "70123433", "70123432", "70123442", "70123435", "70123434", "70123449", "70123450", "70123436", "70123427", "70123439", "70123438", "70123441", "70123440", "70123443", "70123437", "70123444", "70123445", "70123448", "70123447",
      -- Season 6
      "70142105", "70142104", "70142103", "70142111", "70142112", "70142124", "70142109", "70142125", "70142108", "70142107", "70142106", "70142102", "70142113", "70142116", "70142120", "70142114", "70142117", "70142118", "70142123", "70142122", "70142115", "70142121", "70142110", "70142119",
      -- Season 7
      "70189750", "70189753", "70189754", "70189751", "70189757", "70189756", "70189749", "70189748", "70189747", "70189759", "70189746", "70189758", "70189760", "70189761", "70189762", "70189745", "70189755", "70189763", "70189764", "70189765", "70189744", "70189752",
      -- Season 8
      "70219027", "70219047", "70219039", "70219033", "70219046", "70219045", "70219040", "70219041", "70219030", "70219032", "70219035", "70219050", "70219037", "70219036", "70219049", "70219038", "70219048", "70219042", "70219028", "70219029", "70219044", "70219034", "70219031", "70219043",
      -- Season 9
      "70247931", "70247937", "70247927", "70247940", "70247925", "70247920", "70247921", "70247939", "70247924", "70247919", "70247928", "70247932", "70247933", "70247922", "70247935", "70247926", "70247929", "70247923", "70247930", "70247917", "70247918", "70247938", "70247936", "70247934",
      -- Season 10
      "80017967", "70297392", "70297376", "70297378", "70297375", "70297380", "70297373", "70297377", "70297386", "70297391", "70297381", "70297389", "70297393", "70297374", "70297385", "70297379", "70297382", "70297394", "70297388", "80017968", "70297383", "70297384", "70297387", "70297390",
      -- Season 11
      "80019166", "80019182", "80064275", "80019171", "80019170", "80019180", "80019169", "80019181", "80019172", "80019184", "80019186", "80019176", "80019168", "80019183", "80019173", "80019167", "80019177", "80019187", "80019165", "80019179", "80064276", "80019175", "80019178", "80019174", "80019164",
      -- Season 12
      "80076741", "80076743", "80076757", "80076753", "80076737", "80076742", "80076754", "80076738", "80076751", "80076748", "80076752", "80076744", "80076734", "80076749", "80076747", "80076745", "80076750", "80076739", "80076735", "80076756", "80076740", "80076755", "80076746", "80076736",
      -- Season 13
      "80143436", "80143447", "80143440", "80143448", "80143434", "80143428", "80143430", "80143435", "80143446", "80143429", "80143443", "80143431", "80143439", "80143438", "80143445", "80143444", "80143433", "80143441", "80180046", "80143442", "80143437", "80143432", "80143449", "80180045",
      -- Season 14
      "80207589", "80207585", "80207592", "80207595", "80207597", "80207591", "80994453", "80207586", "80207588", "80207801", "80207596", "80207583", "80207594", "80207587", "80207584", "80207590", "80207802", "80207581", "80207599", "80994454", "80207582", "80207800", "80207593",
      -- Season 15
      "80988491", "80988489", "80988490", "80988497", "81071919", "80988504", "80988488", "80988500", "81071917", "80988496", "80988501", "80988492", "80988506", "80988493", "80988495", "80988505", "81071918", "80988486", "80988499", "80988498", "80988507", "80988503", "80988487", "80988494", "80988502",
      -- Season 16
      "81282400", "81282385", "81282397", "81282389", "81282402", "81282396", "81282394", "81282403", "81282393", "81282395", "81282384", "81282386", "81282398", "81282388", "81282390", "81282392", "81282399", "81282401", "81282391", "81282383", "81282387",
      -- Season 17
      "81463207", "81463220", "81463214", "81463217", "81463221", "81463222", "81463210", "81463218", "81463209", "81463211", "81463216", "81463219", "81463223", "81463215", "81463212", "81463208", "81463213",
      -- Season 18
      "81608907", "81608903", "81608906", "81608897", "81608896", "81608890", "81608899", "81608901", "81608894", "81608892", "81608909", "81608898", "81608908", "81608895", "81608904", "81608902", "81608905", "81608900", "81608893", "81608891",
      -- Season 19
      -- TODO: Not on Netflix yet
      -- Season 20
      -- TODO: Not on Netflix yet
    }
    local random_episode = episodes[math.random(1, #episodes)]

    ngx.redirect(base_url .. random_episode)
  }
}
