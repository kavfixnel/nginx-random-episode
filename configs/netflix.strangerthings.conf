# This location block redirects a request to a random episode of the show 'Stranger Things'
# https://www.imdb.com/title/tt4574334/
location /netflix/strangerthings {
  content_by_lua_block {
    math.randomseed(ngx.now()*1000)

    local base_url = "https://www.netflix.com/watch/"
    local episodes = {
      -- Season 1
      "80077368", "80077369", "80077370", "80077371", "80077372", "80077373", "80077374", "80077375",
      -- Season 2
      "80117716", "80144891", "80144892", "80144893", "80144894", "80144895", "80144896", "80144897", "80144898",
      -- Season 3
      "80186941", "80222773", "80222774", "80222775", "80222776", "80222777", "80222778", "80222779",
      -- Season 4
      "80229866", "80229867", "80229868", "80229869", "80229870", "80229871", "80229872", "80229873", "81227938",
    }
    local random_episode = episodes[math.random(1, #episodes)]

    ngx.redirect(base_url .. random_episode)
  }
}